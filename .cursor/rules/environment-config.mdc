---
globs: .env*,next.config.*,package.json
description: 環境設定とデプロイメント要件
---

# 環境設定ガイドライン

## 必須環境変数
```bash
# OpenRouter APIキー（必須）
OPENROUTER_API_KEY=your_openrouter_api_key

# OpenRouterモデル（任意、デフォルトは推奨モデル）
OPENROUTER_MODEL=anthropic/claude-3.5-sonnet

# GCP/Vertex/GCS（ADC認証前提）
GOOGLE_CLOUD_PROJECT=
GOOGLE_CLOUD_LOCATION=asia-northeast1
GCS_BUCKET=
```

## 必須依存関係
```json
{
  "dependencies": {
    "@google-cloud/vertexai": "^1",
    "@google-cloud/storage": "^7",
    "next": "15.x",
    "react": "^18 || ^19",
    "typescript": "^5"
  }
}
```

## Next.js設定
```typescript
// next.config.ts
const nextConfig = {
  serverExternalPackages: ['@google/genai','@google-cloud/vertexai','@google-cloud/storage'],
  api: { bodyParser: { sizeLimit: '2gb' } }
}
```

## ファイル制限対応
- **最大ファイルサイズ**: 2GB
- **保存期間**: 48時間（GCS/運用ポリシーに準拠）
- **MIME TYPE**: `video/*`のみ許可

## セキュリティ考慮事項
- APIキーは環境変数で管理
- ファイルアップロード時のバリデーション
- レート制限の実装推奨
- CORS設定（必要に応じて）

## デプロイメント
- Vercel推奨（Next.js 15対応）
- 環境変数の設定を忘れずに
- ビルド時の依存関係確認